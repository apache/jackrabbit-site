
<!-- 
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE- 2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <TITLE>Jackrabbit Configuration</TITLE>
    <LINK type="text/css" rel="stylesheet" href="http://jackrabbit.apache.org/style/site.css">
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY>
    <DIV id="page">
      <DIV id="header">
        <P id="jcr"><A href="http://jackrabbit.apache.org/"><IMG src="http://jackrabbit.apache.org/style/jlogo.gif" alt="Apache Jackrabbit" height="100" width="336"></A></P>
        <P id="asf"><A href="http://www.apache.org/"><IMG src="http://jackrabbit.apache.org/style/asf-logo.gif" alt="Apache Software Foundation" height="100" width="387"></A></P>
      </DIV>
      <DIV id="body">
        <DIV id="navigation">
  <UL>
	<LI>Apache Jackrabbit
	<UL>
		<LI><A href="welcome-to-apache-jackrabbit.html" title="Welcome to Apache Jackrabbit">Welcome</A></LI>
		<LI><A href="downloads.html" title="Downloads">Downloads</A></LI>
		<LI><A href="articles.html" title="Articles">Articles</A></LI>
		<LI><A href="frequently-asked-questions.html" title="Frequently Asked Questions">FAQ</A></LI>
		<LI><A href="http://wiki.apache.org/jackrabbit/FrontPage" class="external-link">Jackrabbit Wiki</A></LI>
		<LI><A href="jackrabbit-history.html" title="Jackrabbit History">Jackrabbit History</A></LI>
	</UL>
	</LI>
	<LI>Documentation
	<UL>
		<LI><A href="getting-started-with-apache-jackrabbit.html" title="Getting Started with Apache Jackrabbit">Getting Started</A></LI>
		<LI><A href="standalone-server.html" title="Standalone Server">Standalone Server</A></LI>
		<LI><A href="jackrabbit-components.html" title="Jackrabbit Components">Jackrabbit Components</A></LI>
		<LI><A href="first-hops.html" title="First Hops">First Hops</A></LI>
		<LI><A href="jcr-api.html" title="JCR & API">JCR &amp; API</A></LI>
		<LI><A href="jackrabbit-architecture.html" title="Jackrabbit Architecture">Jackrabbit Architecture</A></LI>
		<LI><A href="deployment-models.html" title="Deployment Models">Deployment Models</A></LI>
		<LI><A href="" title="Jackrabbit Configuration">Jackrabbit Configuration</A></LI>
		<LI><A href="node-types.html" title="Node Types">Node Types</A></LI>
		<LI><A href="object-content-mapping.html" title="Object Content Mapping">Object Content Mapping</A></LI>
	</UL>
	</LI>
	<LI>Development
	<UL>
		<LI><A href="jackrabbit-team.html" title="Jackrabbit Team">Jackrabbit Team</A></LI>
		<LI><A href="jackrabbit-roadmap.html" title="Jackrabbit Roadmap">Jackrabbit Roadmap</A></LI>
		<LI><A href="building-jackrabbit.html" title="Building Jackrabbit">Building Jackrabbit</A></LI>
		<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
		<LI><A href="issue-tracker.html" title="Issue Tracker">Issue Tracker</A></LI>
		<LI><A href="source-repository.html" title="Source Repository">Source Repository</A></LI>
		<LI><A href="continuous-integration.html" title="Continuous Integration">Continuous Integration</A></LI>
		<LI><A href="website.html" title="Website">Website</A></LI>
		<LI><A href="creating-releases.html" title="Creating Releases">Creating Releases</A></LI>
		<LI><A href="supporting-software-attribution.html" title="Supporting software attribution">Attribution</A></LI>
	</UL>
	</LI>
	<LI>Apache Software Foundation
	<UL>
		<LI><A href="http://www.apache.org/foundation/how-it-works.html" class="external-link">Introduction</A></LI>
		<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link">Sponsorship</A></LI>
		<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link">Current Sponsors</A></LI>
	</UL>
	</LI>
</UL>
        </DIV>
        <DIV id="content">
          <H1>Jackrabbit Configuration</H1>
  <DIV>
<UL>
    <LI><A href="#JackrabbitConfiguration-Repositoryconfiguration">Repository configuration</A></LI>
<UL>
    <LI><A href="#JackrabbitConfiguration-Beanconfigurationelements">Bean configuration elements</A></LI>
    <LI><A href="#JackrabbitConfiguration-Configurationvariables">Configuration variables</A></LI>
</UL>
    <LI><A href="#JackrabbitConfiguration-Securityconfiguration">Security configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Workspaceconfiguration">Workspace configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Versioningconfiguration">Versioning configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Searchconfiguration">Search configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Persistenceconfiguration">Persistence configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Filesystemconfiguration">File system configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Clusterconfiguration">Cluster configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Datastoreconfiguration">Data store configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Itemstatelockingconfiguration">Item state locking configuration</A></LI>
    <LI><A href="#JackrabbitConfiguration-Passwordsinconfiguration%2528asofJackrabbit2.3%2529">Passwords in configuration (as of Jackrabbit 2.3)</A></LI>
</UL></DIV>

<P>Apache Jackrabbit needs two pieces of information to set up a runtime content repository instance:</P>

<UL>
	<LI><B>Repository home directory</B> The filesystem path of the directory containing the content repository accessed by the runtime instance of Jackrabbit. This directory usually contains all the repository content, search indexes, internal configuration, and other persistent information managed within the content repository. Note that this is not absolutely required and some persistence managers and other Jackrabbit components may well be configured to access files and even other resources (like remote databases) outside the repository home directory. A designated repository home directory is however always needed even if some components choose to not use it. Jackrabbit will automatically fill in the repository home directory with all the required files and subdirectories when the repository is first instantiated.</LI>
</UL>


<UL>
	<LI><B>Repository configuration file</B> The filesystem path of the repository configuration XML file. This file specifies the class names and properties of the various Jackrabbit components used to manage and access the content repository. Jackrabbit parses this configuration file and instantiates the specified components when the runtime content repository instance is created.</LI>
</UL>


<P>These two configuration parameters are passed either directly to Jackrabbit when creating a repository instance or indirectly through settings for a JNDI object factory or some other component management system.</P>

<P>For each workspace that was created, there will also be a workspace.xml file created inside the workspace home directory that will be used for the workspace - these files have to be changed, too, because the workspace-specific configuration inside repository.xml is only used as a template for new workspaces, ie. if you use the <TT>createWorkspace()</TT> method of the Jackrabbit API, the workspace.xml is just a copy of the <A href="#JackrabbitConfiguration-Workspaceconfiguration">Workspace</A> element inside repository.xml. You can also manually create the workspace folder with a workspace.xml file to create a new workspace yourself (Please note that depending on the <A href="#JackrabbitConfiguration-Persistenceconfiguration">persistence manager</A> you will also have to setup a database and configure the access to it).</P>

<H2><A name="JackrabbitConfiguration-Repositoryconfiguration"></A>Repository configuration</H2>

<P>The repository configuration file, typically called <TT>repository.xml</TT>, specifies global options like security, versioning and clustering settings. A default workspace configuration template is also included in the repository configuration file. The exact format of this XML configuration file is defined in the following document type definition (DTD) files published by the Apache Jackrabbit project.</P>

<UL>
	<LI><A href="http://jackrabbit.apache.org/dtd/repository-1.5.dtd" class="external-link">-//The Apache Software Foundation//DTD Jackrabbit 1.5//EN</A></LI>
	<LI><A href="http://jackrabbit.apache.org/dtd/repository-1.4.dtd" class="external-link">-//The Apache Software Foundation//DTD Jackrabbit 1.4//EN</A></LI>
	<LI><A href="http://jackrabbit.apache.org/dtd/repository-1.2.dtd" class="external-link">-//The Apache Software Foundation//DTD Jackrabbit 1.2//EN</A></LI>
	<LI><A href="http://jackrabbit.apache.org/dtd/repository-1.0.dtd" class="external-link">-//The Apache Software Foundation//DTD Jackrabbit 1.0//EN</A></LI>
</UL>


<P>All Jackrabbit 1.x versions are fully backwards compatible, so you can use a recent Jackrabbit version without having to modify your existing repository configuration. Of course you will need to make configuration changes if you want to enable new features like the data store introduced in Jackrabbit 1.4.</P>

<P>The top-level structure of the repository configuration file is shown below. The <TT>&lt;!DOCTYPE&gt;</TT> declaration is optional, but if you include it Jackrabbit 1.5 will use XML validation to make sure that the configuration file is correctly formatted.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
&lt;!DOCTYPE Repository
          PUBLIC <SPAN class="code-quote">&quot;-//The Apache Software Foundation//DTD Jackrabbit 1.5//EN&quot;</SPAN>
          <SPAN class="code-quote">&quot;http://jackrabbit.apache.org/dtd/repository-1.5.dtd&quot;</SPAN>&gt;
<SPAN class="code-tag">&lt;Repository&gt;</SPAN>
  <SPAN class="code-tag">&lt;FileSystem .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;Security .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;Workspaces .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;Workspace .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;Versioning .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;SearchIndex .../&gt;</SPAN>    <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional --&gt;</SPAN></SPAN>
  <SPAN class="code-tag">&lt;Cluster .../&gt;</SPAN>        <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional, available since 1.2 --&gt;</SPAN></SPAN>
  <SPAN class="code-tag">&lt;DataStore .../&gt;</SPAN>      <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional, available since 1.4 --&gt;</SPAN></SPAN>
<SPAN class="code-tag">&lt;/Repository&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>Starting with Jackrabbit 1.5, the order of the configuration elements below <TT>&lt;Repository/&gt;</TT> is now fixed.</P>

<P>The repository configuration elements are:</P>

<UL>
	<LI><TT><A href="#JackrabbitConfiguration-Filesystemconfiguration">FileSystem</A></TT>: The virtual file system used by the repository to store things like registered namespaces and node types.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Securityconfiguration">Security</A></TT>: Authentication and authorization configuration.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Workspaceconfiguration">Workspaces</A></TT>: Configuration on where and how workspaces are managed.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Workspaceconfiguration">Workspace</A></TT>: Default workspace configuration template.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Versioningconfiguration">Versioning</A></TT>:  Configuration of the repository-wide version store.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Searchconfiguration">SearchIndex</A></TT>: Configuration of the search index that covers the repository-wide <TT>/jcr:system</TT> content tree.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Clusterconfiguration">Cluster</A></TT>: Clustering configuration.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Datastoreconfiguration">DataStore</A></TT>: Data store configuration.</LI>
</UL>


<P>See the Jackrabbit 1.5 <A href="jackrabbit-configuration.data/repository.xml">default configuration</A>, for an example repository configuration file.</P>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>It is a good idea to place the <TT>repository.xml</TT> file <EM>inside</EM> the repository home directory. This keeps your repository and its configuration nicely contained within a single directory tree.</TD></TR></TABLE></DIV> 

<H3><A name="JackrabbitConfiguration-Beanconfigurationelements"></A>Bean configuration elements</H3>

<P>Most of the entries in the configuration file are based on the following generic JavaBean configuration pattern. Such configuration specifies that the repository should use an instance of the specified class with the specified properties for the named functionality.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;ConfigurationElement class=<SPAN class="code-quote">&quot;fully.qualified.ClassName&quot;</SPAN>&gt;</SPAN>
  <SPAN class="code-tag">&lt;param name=<SPAN class="code-quote">&quot;property1&quot;</SPAN> value=<SPAN class="code-quote">&quot;...&quot;</SPAN>&gt;</SPAN>
  <SPAN class="code-tag">&lt;param name=<SPAN class="code-quote">&quot;property2&quot;</SPAN> value=<SPAN class="code-quote">&quot;...&quot;</SPAN>&gt;</SPAN>
<SPAN class="code-tag">&lt;ConfigurationElement&gt;</SPAN>
</PRE>
</DIV></DIV>

<H3><A name="JackrabbitConfiguration-Configurationvariables"></A>Configuration variables</H3>

<P>Jackrabbit supports configuration variables of the form <EM>${name}</EM>. These variables can be used to avoid hardcoding specific options in the configuration files. The following variables are available in all Jackrabbit versions:</P>

<UL>
	<LI><TT>${rep.home}:</TT> Repository home directory.</LI>
	<LI><TT>${wsp.name}:</TT> Workspace name. Only available in workspace configuration.</LI>
	<LI><TT>${wsp.home}:</TT> Workspace home directory. Only available in workspace configuration.</LI>
</UL>


<P>Since Jackrabbit 1.4 (see <A href="https://issues.apache.org/jira/browse/JCR-1304" class="external-link">JCR-1304</A>) it has been possible to use system properties or any application-specific settings as configuration variables.</P>

<H2><A name="JackrabbitConfiguration-Securityconfiguration"></A>Security configuration</H2>

<P>The security configuration element is used to specify authentication and authorization settings for the repository. The structure of the security configuration element is:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;Security appName=<SPAN class="code-quote">&quot;Jackrabbit&quot;</SPAN>&gt;</SPAN>
  <SPAN class="code-tag">&lt;SecurityManager .../&gt;</SPAN> <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional, available since 1.5 --&gt;</SPAN></SPAN>
  <SPAN class="code-tag">&lt;AccessManager .../&gt;</SPAN>   <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- mandatory until 1.4, optional since 1.5 --&gt;</SPAN></SPAN>
  <SPAN class="code-tag">&lt;LoginModule .../&gt;</SPAN>     <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional --&gt;</SPAN></SPAN>
<SPAN class="code-tag">&lt;/Security&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>By default Jackrabbit uses the <A href="http://java.sun.com/j2se/1.4.2/docs/guide/security/jaas/JAASRefGuide.html" class="external-link">Java Authentication and Authorization Service</A> (JAAS) to authenticate users who try to access the repository. The <TT>appName</TT> parameter in the <TT>&lt;Security/&gt;</TT> element is used as the JAAS application name of the repository.</P>

<P>If JAAS authentication is not available or (as is often the case) too complex to set up, Jackrabbit allows you to specify a repository-specific JAAS <A href="http://java.sun.com/j2se/1.4.2/docs/api/javax/security/auth/spi/LoginModule.html" class="external-link">LoginModule</A> that is then used for authenticating repository users. The default <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/security/SimpleLoginModule.html" class="external-link">SimpleLoginModule</A> class included in Jackrabbit implements a trivially simple authentication mechanism that accepts any username and any password as valid authentication credentials.</P>

<P>Once a user has been authenticated, Jackrabbit will use the configured <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/security/AccessManager.html" class="external-link">AccessManager</A> to control what parts of the repository content the user is allowed to access and modify. The default <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/security/SimpleAccessManager.html" class="external-link">SimpleAccessManager</A> class included in Jackrabbit implements a trivially simple authorization mechanism that grants full read access to all users and write access to everyone except anonymous users.</P>

<P>The slightly more advanced <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/security/SimpleJBossAccessManager.html" class="external-link">SimpleJBossAccessManager</A> class was added in Jackrabbit 1.3 (see <A href="https://issues.apache.org/jira/browse/JCR-650" class="external-link">JCR-650</A>). This class is designed for use with the <A href="http://www.jboss.org/jbossas/" class="external-link">JBoss Application Server</A>, where it maps JBoss roles to Jackrabbit permissions.</P>

<H2><A name="JackrabbitConfiguration-Workspaceconfiguration"></A>Workspace configuration</H2>

<P>A Jackrabbit repository contains one or more workspaces that are each configured in a separate <TT>workspace.xml</TT> configuration file. The <TT>Workspaces</TT> element of the repository configuration specifies where and how the workspaces are managed. The repository configuration also contains a default workspace configuration template that is used to create the <TT>workspace.xml</TT> file of a new workspace unless more specific configuration is given when the workspace is created. See the <TT>createWorkspace</TT> methods in the <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/api/JackrabbitWorkspace.html" class="external-link">JackrabbitWorkspace</A> interface for more details on workspace creating workspaces.</P>

<P>The workspace settings in the repository configuration file are:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
&lt;Workspaces rootPath=<SPAN class="code-quote">&quot;${rep.home}/workspaces&quot;</SPAN>
            defaultWorkspace=<SPAN class="code-quote">&quot;default&quot;</SPAN>
            configRootPath=<SPAN class="code-quote">&quot;...&quot;</SPAN>  <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional --&gt;</SPAN></SPAN>
            maxIdleTime=<SPAN class="code-quote">&quot;...&quot;</SPAN>/&gt;   <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional --&gt;</SPAN></SPAN>

<SPAN class="code-tag">&lt;Workspace .../&gt;</SPAN>   <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- default workspace configuration template --&gt;</SPAN></SPAN>
</PRE>
</DIV></DIV>

<P>The following global workspace configuration options are specified in the <TT>Workspaces</TT> element:</P>

<UL>
	<LI><TT>rootPath</TT>: The native file system directory for workspaces. A subdirectory is automatically created for each workspace, and the path of that subdirectory can be used in the workspace configuration as the {{${wsp.path} }}variable.</LI>
	<LI><TT>defaultWorkspace</TT>: Name of the default workspace. This workspace is automatically created when the repository is first started.</LI>
	<LI><TT>configRootPath</TT>: By default the configuration of each workspace is stored in a <TT>workspace.xml</TT> file within the workspace directory within the <TT>rootPath</TT> directory. If this option is specified, then the workspace configuration files are stored within the specified path in the virtual file system (see above) configured for the repository.</LI>
	<LI><TT>maxIdleTime</TT>: By default Jackrabbit only releases resources associated with an opened workspace when the entire repository is closed. This option, if specified, sets the maximum number of seconds that a workspace can remain unused before the workspace is automatically closed.</LI>
</UL>


<P>The workspace configuration template and all <TT>workspace.xml</TT> configuration files have the following structure:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;Workspace name=<SPAN class="code-quote">&quot;${wsp.name}&quot;</SPAN>&gt;</SPAN>
  <SPAN class="code-tag">&lt;FileSystem .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;PersistenceManager .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;SearchIndex .../&gt;</SPAN>          <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional --&gt;</SPAN></SPAN>
  <SPAN class="code-tag">&lt;ISMLocking .../&gt;</SPAN>           <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional, available since 1.4 --&gt;</SPAN></SPAN>
<SPAN class="code-tag">&lt;/Workspace&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>The workspace configuration elements are:</P>

<UL>
	<LI><TT><A href="#JackrabbitConfiguration-Filesystemconfiguration">FileSystem</A></TT>: The virtual file system passed to the persistence manager and search index.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Persistenceconfiguration">PersistenceManager</A></TT>: Persistence configuration for workspace content.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Searchconfiguration">SearchIndex</A></TT>: Configuration of the workspace search index.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Itemstatelockingconfiguration">ISMLocking</A></TT>: Locking configuration for concurrent access to workspace content.</LI>
</UL>


<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>To modify the configuration of an existing workspace, you need to change the <TT>workspace.xml</TT> file of that workspace. Changing the <TT>&lt;Workspace/&gt;</TT> element in the repository configuration file will not affect existing workspaces.</TD></TR></TABLE></DIV>

<H2><A name="JackrabbitConfiguration-Versioningconfiguration"></A>Versioning configuration</H2>

<P>The version histories of all versionable nodes are stored in a repository-wide version store configured in the <TT>Versioning</TT> element of the repository configuration. The versioning configuration is much like workspace configuration as they are both used by Jackrabbit for storing content. The main difference between versioning and workspace configuration is that no search index is specified for the version store as version histories are indexed and searched using the repository-wide search index. Another difference is that there are no {{${wsp.name} }}or {{${wsp.path} }}variables for the versioning configuration. Instead the native file system path of the version store is explicitly specified in the configuration.</P>

<P>The structure of the versioning configuration is:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;Versioning rootPath=<SPAN class="code-quote">&quot;${rep.home}/version&quot;</SPAN>&gt;</SPAN>
  <SPAN class="code-tag">&lt;FileSystem .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;PersistenceManager .../&gt;</SPAN>
  <SPAN class="code-tag">&lt;ISMLocking .../&gt;</SPAN>           <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- optional, available since 1.4 --&gt;</SPAN></SPAN>
<SPAN class="code-tag">&lt;/Versioning&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>The versioning configuration elements are:</P>

<UL>
	<LI><TT><A href="#JackrabbitConfiguration-Filesystemconfiguration">FileSystem</A></TT>: The virtual file system passed to the persistence manager.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Persistenceconfiguration">PersistenceManager</A></TT>: Persistence configuration for the version store.</LI>
	<LI><TT><A href="#JackrabbitConfiguration-Itemstatelockingconfiguration">ISMLocking</A></TT>: Locking configuration for concurrent access to workspace content.</LI>
</UL>


<H2><A name="JackrabbitConfiguration-Searchconfiguration"></A>Search configuration</H2>

<P>See the <A href="http://wiki.apache.org/jackrabbit/Search" class="external-link">Search</A> page on the Jackrabbit wiki.</P>

<H2><A name="JackrabbitConfiguration-Persistenceconfiguration"></A>Persistence configuration</H2>

<P>The Persistence Manager is one of the most important parts of the configuration, because it actually takes care of storing the nodes and properties. There are various very different implementations, but most of them are using databases to store the data. If you use a database PM and like to connect to an external database, you might also have to setup the database. This might include access rights for the Jackrabbit database user to allow creation of tables, because the name of the table typically depends on the workspace name (see the individual PM's javadoc for more information).</P>

<P>For large binary properties there is the option to use the <TT><A href="#JackrabbitConfiguration-Datastoreconfiguration">DataStore</A></TT> instead of the Persistence Manager.</P>

<P>For more detailed information and an overview of available PMs, see the <A href="http://wiki.apache.org/jackrabbit/PersistenceManagerFAQ" class="external-link">PersistenceManagerFAQ</A> page on the Jackrabbit wiki.</P>

<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>If you use a database persistence manager, the configured database connection <B>must not</B> be under the control of an external transaction manager. Jackrabbit implements distributed XA transaction support on a higher level, and expects to be in full control of the underlying database connection.</TD></TR></TABLE></DIV>

<H2><A name="JackrabbitConfiguration-Filesystemconfiguration"></A>File system configuration</H2>

<P>Early versions on Jackrabbit were designed to abstract their persistence mechanism using a virtual file system layer defined in the <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/fs/FileSystem.html" class="external-link">FileSystem</A> interface. This low-level approach didn't work that well in practice, and so most of the persistence abstraction is now handled in a higher level. However, certain parts of Jackrabbit still use this file system abstraction.</P>

<P>A virtual file system is configured in a <TT>&lt;FileSystem/&gt;</TT> bean configuration element. See the main file system implementations <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/fs/local/LocalFileSystem.html" class="external-link">LocalFileSystem</A>, <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/fs/db/DatabaseFileSystem.html" class="external-link">DatabaseFileSystem</A> (including subclasses), and <A href="http://jackrabbit.apache.org/api/1.5/org/apache/jackrabbit/core/fs/mem/MemoryFileSystem.html" class="external-link">MemoryFileSystem</A> for the available options. The recommended alternative is to use the LocalFileSystem implementation that simply maps abstract file system accesses to the specified directory within the native file system.</P>

<H2><A name="JackrabbitConfiguration-Clusterconfiguration"></A>Cluster configuration</H2>

<P>See the <A href="http://wiki.apache.org/jackrabbit/Clustering" class="external-link">Clustering</A> page on the Jackrabbit wiki.</P>

<H2><A name="JackrabbitConfiguration-Datastoreconfiguration"></A>Data store configuration</H2>

<P>See the <A href="http://wiki.apache.org/jackrabbit/DataStore" class="external-link">DataStore</A> page on the Jackrabbit wiki.</P>

<H2><A name="JackrabbitConfiguration-Itemstatelockingconfiguration"></A>Item state locking configuration</H2>

<P>TODO</P>

<H2><A name="JackrabbitConfiguration-Passwordsinconfiguration%28asofJackrabbit2.3%29"></A>Passwords in configuration (as of Jackrabbit 2.3)</H2>

<P>When using a database-backed persistence manager or another component, you usually need to include the database password in Jackrabbit configuration. If you don't want to store such passwords in plain text inside the configuration file, you can encode the password in base64 and prefix it with &quot;{base64}&quot;. Jackrabbit will automatically decode such a password before passing it to the underlying database.</P>

<P>As an example, the following two password configuration parameters are equivalent (&quot;dGVzdA==&quot; is the base64 encoding of &quot;test&quot;):</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;param name=<SPAN class="code-quote">&quot;password&quot;</SPAN> value=<SPAN class="code-quote">&quot;test&quot;</SPAN>/&gt;</SPAN>
<SPAN class="code-tag">&lt;param name=<SPAN class="code-quote">&quot;password&quot;</SPAN> value=<SPAN class="code-quote">&quot;{base64}dGVzdA==&quot;</SPAN>/&gt;</SPAN>
</PRE>
</DIV></DIV>
        </DIV>
        <DIV id="end"></DIV>
      </DIV>
      <DIV id="footer">
        <P>
          &copy; 2004-2010 The Apache Software Foundation.
          - <A href="http://jackrabbit.apache.org/privacy-policy.html">Privacy Policy</A> -
          [<A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=75311">edit this page</A>]
          <BR>
          Apache Jackrabbit, Jackrabbit, Apache, the Apache feather logo, and the Apache
          Jackrabbit project logo are trademarks of The Apache Software Foundation.
        </P>
      </DIV>
    </DIV>
<!-- JCR- 1315: Add Google Analytics to Jackrabbit web site -->
<SCRIPT type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>
<SCRIPT type="text/javascript">
var pageTracker = _gat._getTracker("UA-837900-2");
pageTracker._initData();
pageTracker._trackPageview();
</SCRIPT>
  </BODY>
</HTML>
