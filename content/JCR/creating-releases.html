
<!-- 
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE- 2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License. 
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <TITLE>Creating Releases</TITLE>
    <LINK type="text/css" rel="stylesheet" href="http://jackrabbit.apache.org/style/site.css">
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY>
    <DIV id="page">
      <DIV id="header">
        <P id="jcr"><A href="http://jackrabbit.apache.org/"><IMG src="http://jackrabbit.apache.org/style/jlogo.gif" alt="Apache Jackrabbit" height="100" width="336"></A></P>
        <P id="asf"><A href="http://www.apache.org/"><IMG src="http://jackrabbit.apache.org/style/asf-logo.gif" alt="Apache Software Foundation" height="100" width="387"></A></P>
      </DIV>
      <DIV id="body">
        <DIV id="navigation">
  <UL>
	<LI>Apache Jackrabbit
	<UL>
		<LI><A href="welcome-to-apache-jackrabbit.html" title="Welcome to Apache Jackrabbit">Welcome</A></LI>
		<LI><A href="downloads.html" title="Downloads">Downloads</A></LI>
		<LI><A href="articles.html" title="Articles">Articles</A></LI>
		<LI><A href="frequently-asked-questions.html" title="Frequently Asked Questions">FAQ</A></LI>
		<LI><A href="http://wiki.apache.org/jackrabbit/FrontPage" class="external-link">Jackrabbit Wiki</A></LI>
		<LI><A href="jackrabbit-history.html" title="Jackrabbit History">Jackrabbit History</A></LI>
	</UL>
	</LI>
	<LI>Documentation
	<UL>
		<LI><A href="getting-started-with-apache-jackrabbit.html" title="Getting Started with Apache Jackrabbit">Getting Started</A></LI>
		<LI><A href="standalone-server.html" title="Standalone Server">Standalone Server</A></LI>
		<LI><A href="jackrabbit-components.html" title="Jackrabbit Components">Jackrabbit Components</A></LI>
		<LI><A href="first-hops.html" title="First Hops">First Hops</A></LI>
		<LI><A href="jcr-api.html" title="JCR & API">JCR &amp; API</A></LI>
		<LI><A href="jackrabbit-architecture.html" title="Jackrabbit Architecture">Jackrabbit Architecture</A></LI>
		<LI><A href="deployment-models.html" title="Deployment Models">Deployment Models</A></LI>
		<LI><A href="jackrabbit-configuration.html" title="Jackrabbit Configuration">Jackrabbit Configuration</A></LI>
		<LI><A href="node-types.html" title="Node Types">Node Types</A></LI>
		<LI><A href="object-content-mapping.html" title="Object Content Mapping">Object Content Mapping</A></LI>
	</UL>
	</LI>
	<LI>Development
	<UL>
		<LI><A href="jackrabbit-team.html" title="Jackrabbit Team">Jackrabbit Team</A></LI>
		<LI><A href="jackrabbit-roadmap.html" title="Jackrabbit Roadmap">Jackrabbit Roadmap</A></LI>
		<LI><A href="building-jackrabbit.html" title="Building Jackrabbit">Building Jackrabbit</A></LI>
		<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
		<LI><A href="issue-tracker.html" title="Issue Tracker">Issue Tracker</A></LI>
		<LI><A href="source-repository.html" title="Source Repository">Source Repository</A></LI>
		<LI><A href="continuous-integration.html" title="Continuous Integration">Continuous Integration</A></LI>
		<LI><A href="website.html" title="Website">Website</A></LI>
		<LI><A href="" title="Creating Releases">Creating Releases</A></LI>
		<LI><A href="supporting-software-attribution.html" title="Supporting software attribution">Attribution</A></LI>
	</UL>
	</LI>
	<LI>Apache Software Foundation
	<UL>
		<LI><A href="http://www.apache.org/foundation/how-it-works.html" class="external-link">Introduction</A></LI>
		<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link">Sponsorship</A></LI>
		<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link">Current Sponsors</A></LI>
	</UL>
	</LI>
</UL>
        </DIV>
        <DIV id="content">
          <H1>Creating Releases</H1>
  <P>This is a how to document for creating Apache Jackrabbit releases. It documents the current release process and needs to be updated as we move forward.</P>

<H2><A name="CreatingReleases-Releaseplanning"></A>Release planning</H2>

<P>Jackrabbit releases are created based on user demand and the availability of fixes and other requested changes. Any committer can declare their plan to cut a release by sending a &quot;Apache Jackrabbit x.y.z release plan&quot; message to the dev@ list. The plan should refer to Jira for the list of fixes to be included in the release and give a rough estimate of the release schedule. It's OK to revise the plan if needed.</P>

<P>If you're not a committer, you can send a message to the mailing list asking for a new release to be made. Including the list of specific fixes you need and a short rationale of why you need the release.</P>

<H2><A name="CreatingReleases-Prerequisitesforreleasemanagers"></A>Prerequisites for release managers</H2>

<P>You need to be a Jackrabbit committer to prepare and perform a release, but anyone is welcome to help test the release candidates and comment on the release plans.</P>

<P>You should have a code signing key that is included in the Jackrabbit KEYS file. See <A href="#CreatingReleases-AppendixA">Appendix A</A> at the end of this page for more details.</P>

<P>You also need to tell Maven your Subversion credentials needed for deploying artifacts to the Nexus server at <A href="https://repository.apache.org/" class="external-link">https://repository.apache.org/</A>. See <BR>
<A href="#CreatingReleases-AppendixB">Appendix B</A> for the required settings.</P>

<H2><A name="CreatingReleases-Releasemanagementtasks"></A>Release management tasks</H2>

<OL>
	<LI>Make sure that an appropriate version for the release is entered in Jira and that all the related issues have been resolved.</LI>
	<LI>Create a <TT>RELEASE-NOTES.txt</TT> file in the root folder of the project to be released. If such a file already exists, update it for the release. When done, commit the file. See <A href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=10591&version=12319480" class="external-link">previous release notes</A> for examples of what to include. The release note report in Jira is a useful source of required information.</LI>
	<LI>Build and deploy the release artifacts with Maven. See <A href="#CreatingReleases-ReleaseArtifacts">below</A> for the exact steps.</LI>
	<LI>Close the <A href="https://repository.apache.org/index.html#stagingRepositories" class="external-link">staged repository</A> on repository.apache.org.</LI>
	<LI>Upload the artifacts to your account on people.apache.org (instructions at the end of the build)
  <DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
  scp -r target/checkout/target/2.2.12 &lt;username&gt;@people.apache.org:public_html/jackrabbit/
  </PRE>
</DIV></DIV></LI>
	<LI>Start the vote thread, wait 72 hours. See the vote template generated by the Maven build.</LI>
	<LI>If the vote fails (easy case first) remove the tag from svn and drop the staged repository - done</LI>
	<LI>If the vote is successful
	<OL>
		<LI>close the vote by publishing the results</LI>
		<LI>copy the release archives to the dist directory on www.apache.org (/www/www.apache.org/dist/jackrabbit/), delete the old release there (it's automatically archived),
  <DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
   # assuming that the release version is 2.2.12, these are the following steps you need to go through
   # move release archives to dist
   mv ~/public_html/jackrabbit/2.2.12 /www/www.apache.org/dist/jackrabbit
   cd /www/www.apache.org/dist/jackrabbit
   # change group ownership to jackrabbit user, and allow it 'write' right
   chgrp -R jackrabbit /www/www.apache.org/dist/jackrabbit/2.2.12
   chmod g+w 2.2.12
   # delete old release
   rm -rf 2.2.11
   </PRE>
</DIV></DIV></LI>
		<LI>release the <A href="https://repository.apache.org/index.html#stagingRepositories" class="external-link">staged repository</A> for synchronization to Maven central.</LI>
		<LI>mark the version as released in Jira: <A href="https://issues.apache.org/jira/browse/JCR" class="external-link">Jira Project Home</A> -&gt; Project Summary -&gt; Administer Project. Under Versions, click &lt;More&gt;. You'll see all the defined project versions. From the settings menu, choose 'Release' on the version.</LI>
		<LI>close all the issues included in the release: <A href="https://issues.apache.org/jira/browse/JCR" class="external-link">Jira Project Home</A> -&gt; Change Log -&gt; Choose the released version. From the issue list you have the option to bulk update all of the included issues. Just 'Transition Issues' from 'Resolved' to 'Closed' and you are done!</LI>
	</OL>
	</LI>
	<LI>Update the Jackrabbit web site to point to the new release.</LI>
	<LI>Send the release announcement once the web site and download mirrors have been synced.</LI>
</OL>


<P><A name="CreatingReleases-ReleaseArtifacts"></A></P>
<H2><A name="CreatingReleases-Stepstobuildthereleaseartifacts"></A>Steps to build the release artifacts </H2>

<P>The release is built using the Maven release plugin. See the <A href="http://maven.apache.org/developers/release/releasing.html" class="external-link">Releasing a Maven project</A> guide for more details. Make sure you have added the pgp key information in you maven settings file, especially if you have more than one key installed locally. See <A href="#CreatingReleases-AppendixB">Appendix B</A> for the details.</P>

<OL>
	<LI>Execute <TT>mvn release:prepare</TT>. This will update the POM files and tag the release in svn.</LI>
	<LI>Execute <TT>mvn release:perform</TT>. This will build the tagged release and deploy the artifacts to a staging repository on repository.apache.org. The non-Maven release artifacts are automatically deployed to your home directory on people.apache.org. You only need to add the keyname if you have multiple keys and the code signing keys is not your default key.</LI>
</OL>


<H2><A name="CreatingReleases-RelatedLinks"></A>Related Links</H2>

<UL>
	<LI><A href="http://www.apache.org/dev/release.html" class="external-link">http://www.apache.org/dev/release.html</A></LI>
	<LI><A href="http://www.apache.org/dev/release-signing.html" class="external-link">http://www.apache.org/dev/release-signing.html</A></LI>
	<LI><A href="http://wiki.apache.org/incubator/SigningReleases" class="external-link">http://wiki.apache.org/incubator/SigningReleases</A></LI>
	<LI><A href="http://www.apache.org/dev/repository-faq.html" class="external-link">http://www.apache.org/dev/repository-faq.html</A></LI>
</UL>


<P><A name="CreatingReleases-AppendixA"></A></P>
<H2><A name="CreatingReleases-AppendixA%3ACreateandaddyourkeytotheJackrabbitKEYSfile"></A>Appendix A: Create and add your key to the Jackrabbit KEYS file </H2>

<P>Follow these instructions to generate your code signing key and to add it to the Jackrabbit KEYS file.</P>

<OL>
	<LI><A href="http://www.apache.org/dev/release-signing.html#generate" class="external-link">Generate a code signing key</A> using your @apache.org address as the email and &quot;CODE SIGNING KEY&quot; as the comment.</LI>
	<LI>The Jackrabbit KEYS file is managed in <A href="https://svn.apache.org/repos/asf/jackrabbit/dist/KEYS" class="external-link">https://svn.apache.org/repos/asf/jackrabbit/dist/KEYS</A>. To modify the file, first checkout the dist directory:
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-none">
svn checkout https://svn.apache.org/repos/asf/jackrabbit/dist
</PRE>
</DIV></DIV></LI>
	<LI>See the beginning of the KEYS file for instructions on how to append your key to the file.</LI>
	<LI>Once you've committed the changes, update the KEYS file on <TT>people.apache.org</TT>:
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-none">
umask 002; svn update /www/www.apache.org/dist/jackrabbit
</PRE>
</DIV></DIV></LI>
	<LI>You are <B>DONE</B>, but to see the changes on <A href="http://www.apache.org/dist/jackrabbit/KEYS" class="external-link">http://www.apache.org/dist/jackrabbit/KEYS</A> you must wait 2 hours</LI>
</OL>


<P>You should get your key <A href="http://www.apache.org/dev/release-signing.html#apache-wot" class="external-link">linked to the Apache web of trust</A>. Once other people have signed your key, you can update the KEYS file with the signatures you've received.</P>

<P><A name="CreatingReleases-AppendixB"></A></P>
<H2><A name="CreatingReleases-AppendixB%3AMavensettings"></A>Appendix B: Maven settings </H2>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;settings&gt;</SPAN>
...
  <SPAN class="code-tag">&lt;servers&gt;</SPAN>
    <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- To deploy a Jackrabbit snapshot --&gt;</SPAN></SPAN>
    <SPAN class="code-tag">&lt;server&gt;</SPAN>
      <SPAN class="code-tag">&lt;id&gt;</SPAN>apache.snapshots.https<SPAN class="code-tag">&lt;/id&gt;</SPAN>
      <SPAN class="code-tag">&lt;username&gt;</SPAN> <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- YOUR APACHE SVN USERNAME --&gt;</SPAN></SPAN> <SPAN class="code-tag">&lt;/username&gt;</SPAN>
      <SPAN class="code-tag">&lt;password&gt;</SPAN> <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- YOUR APACHE SVN PASSWORD --&gt;</SPAN></SPAN> <SPAN class="code-tag">&lt;/password&gt;</SPAN>
    <SPAN class="code-tag">&lt;/server&gt;</SPAN>
    <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- To stage a Jackrabbit release --&gt;</SPAN></SPAN>
    <SPAN class="code-tag">&lt;server&gt;</SPAN>
      <SPAN class="code-tag">&lt;id&gt;</SPAN>apache.releases.https<SPAN class="code-tag">&lt;/id&gt;</SPAN>
      <SPAN class="code-tag">&lt;username&gt;</SPAN> <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- YOUR APACHE SVN USERNAME --&gt;</SPAN></SPAN> <SPAN class="code-tag">&lt;/username&gt;</SPAN>
      <SPAN class="code-tag">&lt;password&gt;</SPAN> <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- YOUR APACHE SVN PASSWORD --&gt;</SPAN></SPAN> <SPAN class="code-tag">&lt;/password&gt;</SPAN>
    <SPAN class="code-tag">&lt;/server&gt;</SPAN>
    ...
    <SPAN class="code-tag">&lt;profiles&gt;</SPAN>
      <SPAN class="code-tag">&lt;profile&gt;</SPAN>
        <SPAN class="code-tag">&lt;id&gt;</SPAN>apache-release<SPAN class="code-tag">&lt;/id&gt;</SPAN>
        <SPAN class="code-tag">&lt;properties&gt;</SPAN>
          <SPAN class="code-tag">&lt;gpg.keyname&gt;</SPAN><SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- enough of the key id to id it --&gt;</SPAN></SPAN><SPAN class="code-tag">&lt;/gpg.keyname&gt;</SPAN>

          <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- pick one of the following --&gt;</SPAN></SPAN>

          <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- either you feel comfortable with the passphrase on disk --&gt;</SPAN></SPAN>
          <SPAN class="code-tag">&lt;gpg.passphrase&gt;</SPAN><SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- your passphrase for your gpg key goes here--&gt;</SPAN></SPAN><SPAN class="code-tag">&lt;/gpg.passphrase&gt;</SPAN>

          <SPAN class="code-tag"><SPAN class="code-comment">&lt;!-- or you use an agent--&gt;</SPAN></SPAN>
          <SPAN class="code-tag">&lt;gpg.useagent&gt;</SPAN>true<SPAN class="code-tag">&lt;/gpg.useagent&gt;</SPAN>

        <SPAN class="code-tag">&lt;/properties&gt;</SPAN>
      <SPAN class="code-tag">&lt;/profile&gt;</SPAN>
      ...
    <SPAN class="code-tag">&lt;/profiles&gt;</SPAN>
  <SPAN class="code-tag">&lt;/servers&gt;</SPAN>
<SPAN class="code-tag">&lt;/settings&gt;</SPAN>
</PRE>
</DIV></DIV>
        </DIV>
        <DIV id="end"></DIV>
      </DIV>
      <DIV id="footer">
        <P>
          &copy; 2004-2010 The Apache Software Foundation.
          - <A href="http://jackrabbit.apache.org/privacy-policy.html">Privacy Policy</A> -
          [<A href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=80946">edit this page</A>]
          <BR>
          Apache Jackrabbit, Jackrabbit, Apache, the Apache feather logo, and the Apache
          Jackrabbit project logo are trademarks of The Apache Software Foundation.
        </P>
      </DIV>
    </DIV>
<!-- JCR- 1315: Add Google Analytics to Jackrabbit web site -->
<SCRIPT type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>
<SCRIPT type="text/javascript">
var pageTracker = _gat._getTracker("UA-837900-2");
pageTracker._initData();
pageTracker._trackPageview();
</SCRIPT>
  </BODY>
</HTML>
